# v0.5 Excel Workbook Specification

**Status:** Draft
**Authors:** CLIENT Agent, UI Agent
**Approved By:** PM Agent

---

## 1. User Flow (CLIENT Perspective)
1.  **Input:** Engineer pastes beam data into `BEAM_INPUT` sheet (from ETABS or manual).
2.  **Action:** Engineer clicks "Run Design" on the `HOME` sheet.
3.  **Process:** System validates inputs, calculates reinforcement, and checks shear.
4.  **Output:**
    - `BEAM_DESIGN` sheet populates with results (Ast, Asc, Shear Spacing, Status).
    - `BEAM_SCHEDULE` sheet updates with a simplified "Drafting View".
    - `LOG` sheet records any errors (e.g., "Row 5: Mu exceeds limit").

---

## 2. Data Structures

### 2.1 Input Table (`tbl_BeamInput`)
*Location: Sheet 'BEAM_INPUT'*

| Column Name | Data Type | Units | Validation | Description |
|-------------|-----------|-------|------------|-------------|
| ID | String | - | Unique | Beam Label (e.g., B1) |
| Story | String | - | - | Story Label (e.g., Story1) |
| Span | String | - | - | Span Location (Start/Mid/End) |
| b | Double | mm | > 0 | Width |
| D | Double | mm | > 0 | Overall Depth |
| Cover | Double | mm | > 0 | Effective Cover |
| fck | Double | N/mm² | List | Concrete Grade (20, 25, 30...) |
| fy | Double | N/mm² | List | Steel Grade (415, 500, 550) |
| Mu | Double | kN·m | >= 0 | Factored Bending Moment |
| Vu | Double | kN | >= 0 | Factored Shear Force |
| Flanged | Boolean | - | Yes/No | Is it a T/L beam? |
| Df | Double | mm | >= 0 | Flange Depth (if Flanged) |
| bf | Double | mm | >= 0 | Flange Width (if Flanged) |

### 2.2 Design Table (`tbl_BeamDesign`)
*Location: Sheet 'BEAM_DESIGN'*
*Note: Contains all Input columns + the following Results:*

| Column Name | Data Type | Units | Description |
|-------------|-----------|-------|-------------|
| d_eff | Double | mm | Effective Depth (D - Cover) |
| Mu_Lim | Double | kN·m | Limiting Moment Capacity |
| Status | String | - | "OK", "FAIL", "Check Shear" |
| Ast_Req | Double | mm² | Tension Steel Required |
| Pt_Prov | Double | % | Percentage of Tension Steel |
| Asc_Req | Double | mm² | Compression Steel Required (if Doubly) |
| Tv | Double | N/mm² | Nominal Shear Stress |
| Tc | Double | N/mm² | Concrete Shear Capacity |
| Shear_Sts | String | - | "Safe", "Shear Reinf", "Unsafe" |
| Stirrups | String | - | e.g., "2L-8mm @ 150 c/c" |
| Remarks | String | - | Failure reasons or warnings |

---

## 3. UI Layout (UI Agent)

### 3.1 Sheet: HOME
- **Header:** Project Title, Version Info.
- **Dashboard:**
    - Count of Total Beams.
    - Count of Passed/Failed.
- **Controls (Buttons):**
    - `[Run Design]` (Triggers `Main_RunDesign`)
    - `[Clear Results]` (Triggers `Main_Clear`)
    - `[Import Data]` (Triggers `Import_CSV`)

### 3.2 Styles
- **Input Cells:** Light Yellow (`RGB(255, 255, 204)`)
- **Output Cells:** Light Grey (`RGB(242, 242, 242)`)
- **Error Text:** Red (`RGB(255, 0, 0)`)
- **Success Text:** Green (`RGB(0, 128, 0)`)

---

## 4. Implementation Plan
1.  **Setup Script (`M99_Setup.bas`):** Generates the above structure.
2.  **App Layer (`M11_AppLayer.bas`):** Reads `tbl_BeamInput`, loops, calls Library, writes `tbl_BeamDesign`.
