<html><head><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Programming Concepts Used in the CSi API</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="4ccfd234-74e8-406a-a36c-330af0973348" /><meta name="Description" content="Some of the programming concepts and definitions that apply to the CSI API are explained herein." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">CSI API ETABS v1</div><div class="pageBody"><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Programming Concepts Used in the CSi API</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>This topic contains the following sections:</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#OptionBase">Option Base</a></li><li class="outlineSectionEntry"><a href="#FixedAndDynamicArrays">Fixed-Size and Dynamic Arrays</a></li><li class="outlineSectionEntry"><a href="#OptionalArguments">Optional Arguments</a></li><li class="outlineSectionEntry"><a href="#ByValByRef">ByVal and ByRef</a></li></ul><p>
        Some of the programming concepts and definitions that apply
        to the CSI API are explained herein.
      </p></div><div class="collapsibleAreaRegion" id="OptionBase"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Option Base</span></div><div id="ID0RBSection" class="collapsibleSection"><p>
          ETABS uses a lower bound of 0 for all arrays.
          Any program that accesses ETABS through the API
          should also use a lower bound of 0 for its arrays.
        </p></div><div class="collapsibleAreaRegion" id="FixedAndDynamicArrays"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Fixed-Size and Dynamic Arrays</span></div><div id="ID2RBSection" class="collapsibleSection"><p>
          Arrays can be used to refer to a series of variables by the same name
          and to use a number (an index) to distinguish them.
          Visual Basic has two types of arrays:  fixed-size and dynamic.
          A fixed-size array always remains the same size.
          A dynamic array can change its size while the program is running.
        </p><p>
          A fixed-size array is declared with the size indicated. For example, the following line declares MyFixedArray dimensioned to 2.
        </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EAHADAAA_tab1" class="codeSnippetContainerTabSingle">VB</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAHADAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAHADAAA');return false;" title="Copy">Copy</a></div></div><div id="ID1EAHADAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">Dim</span> MyFixedArray(<span class="highlight-number">2</span>)<span class="highlight-keyword">as</span> <span class="highlight-keyword">Double</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAHADAAA");</script><p>
          Dimensioning the array to 2 means that it holds three data items:
        </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EAFADAAA_tab1" class="codeSnippetContainerTabSingle">VB</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAFADAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAFADAAA');return false;" title="Copy">Copy</a></div></div><div id="ID1EAFADAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">MyFixedArray(<span class="highlight-number">0</span>) = first data item
MyFixedArray(<span class="highlight-number">1</span>) = second data item
MyFixedArray(<span class="highlight-number">2</span>) = third data item</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAFADAAA");</script><p>
          Dynamic arrays are declared with no size indicated as shown here:
        </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EADADAAA_tab1" class="codeSnippetContainerTabSingle">VB</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EADADAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EADADAAA');return false;" title="Copy">Copy</a></div></div><div id="ID1EADADAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">Dim</span> MyDynamicArray()<span class="highlight-keyword">as</span> <span class="highlight-keyword">Double</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EADADAAA");</script><p>
          Dynamic arrays are dimensioned sometime after they are declared using a statement such as the following:
        </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EABADAAA_tab1" class="codeSnippetContainerTabSingle">VB</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EABADAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EABADAAA');return false;" title="Copy">Copy</a></div></div><div id="ID1EABADAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">ReDim</span> MyDynamicArray(<span class="highlight-number">2</span>)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EABADAAA");</script><p>
          Any array that is dimensioned inside ETABS must be declared
          as a dynamic array so that ETABS can redimension it.
          It is probably a good idea to declare all arrays as dynamic arrays for simplicity.
          As an example, the analysis results obtained through the CSI API are stored
          in arrays that are defined as dynamic arrays by the user and then dimensioned and filled inside of ETABS.
        </p></div><div class="collapsibleAreaRegion" id="OptionalArguments"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Optional Arguments</span></div><div id="ID3RBSection" class="collapsibleSection"><p>
          Some of the CSI API functions have optional arguments.
          For example, the CountLoadDispl function has two optional arguments: Name and LoadPat.
          It is not necessary to include the optional arguments when calling this function.
          All four of the following calls are valid.
        </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EABACAAA_tab1" class="codeSnippetContainerTabSingle">VB</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EABACAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EABACAAA');return false;" title="Copy">Copy</a></div></div><div id="ID1EABACAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">ret = SapModel.PointObj.CountLoadDispl(Count)

ret = SapModel.PointObj.CountLoadDispl(Count, Name)

ret = SapModel.PointObj.CountLoadDispl(Count, , LoadPat)

ret = SapModel.PointObj.CountLoadDispl(Count, Name, LoadPat)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EABACAAA");</script><p>
          Note in the third example, the first optional item is not included
          and the second optional item is included.
          In that case, commas must be used to delineate the missing arguments.
        </p></div><div class="collapsibleAreaRegion" id="ByValByRef"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />ByVal and ByRef</span></div><div id="ID4RBSection" class="collapsibleSection"><p>
          Variables are passed to the CSI API functions using the ByRef or the ByVal keyword.
        </p><p>
          ByVal means that the variable is passed by value.
          This allows the CSI API to access a copy of the variable
          but not the original variable. This means the value of the variable
          in another application can not be changed by the API.
        </p><p>
          ByRef means the argument is passed by reference.
          This passes the address of the variable to the CSI API
          instead of passing a copy of the value. It allows the CSI API
          to access the actual variable, and, as a result,
          allows ETABS to change the variable's actual value in an application.
        </p><p>
          Variables are passed ByRef when data needs to be
          returned in them from ETABS to your application.
          In addition, the API requires that all arrays be passed ByRef.
        </p></div></div></div><div id="pageFooter" class="pageFooter">ETABS®, SAFE®, SAP2000® and CSiBridge® are registered trademarks of Computers and Structures, Inc.<br /><p><a href="https://www.csiamerica.com" target="_blank" rel="noopener noreferrer">Copyright © Computers and Structures, Inc. 2024. All rights reserved.</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:support%40csiamerica.com?Subject=CSI%20API%20ETABS%20v1">support@csiamerica.com</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>