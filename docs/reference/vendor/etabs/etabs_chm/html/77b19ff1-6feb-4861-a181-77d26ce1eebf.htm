<html><head><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Information for Plugin Developers</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="77b19ff1-6feb-4861-a181-77d26ce1eebf" /><meta name="Description" content="As an alternative to external API clients, plugins that are accessible via ETABS menus can be developed to make use of the ETABS API from inside the program." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">CSI API ETABS v1</div><div class="pageBody"><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Information for Plugin Developers</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>This topic contains the following sections:</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#PluginConsiderations">Plugin Considerations</a></li><li class="outlineSectionEntry"><a href="#cPluginClass">The cPlugin Class</a></li><li class="outlineSectionEntry"><a href="#AddingPlugins">Adding Plugins</a></li></ul><p>
				As an alternative to external API clients, plugins that are accessible via ETABS menus can be developed
				to make use of the ETABS API from inside the program.
			</p><p>
				No license is required to use the API for plugin development,
				beyond having a valid license for ETABS. However, technical support for developing with the API is not included.
				For qualified users and third-party developers who would like technical support to help them build solutions
				and integrations with ETABS using the ETABS API, Computers and Structures, Inc.
				has created a subscription-based service, CSI Developer Network (CSIDN)  (see
				<a href="http://www.csiamerica.com/support/csidn" target="_blank" rel="noopener noreferrer">http://www.csiamerica.com/support/csidn</a>
				). Developers must subscribe to CSIDN to be eligible for technical support for the ETABS API.
			</p><p>
				Plugins can be developed in a .NET compatible language (e.g. VB.NET or C#) as a .NET DLL,
				or by using any language capable of creating a COM server compiled as a DLL.
				An example plugin project can be found at:
				<a href="https://wiki.csiamerica.com/x/IpQa" target="_blank" rel="noopener noreferrer">https://wiki.csiamerica.com/x/IpQa</a></p></div><div class="collapsibleAreaRegion" id="PluginConsiderations"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Plugin Considerations</span></div><div id="ID0RBSection" class="collapsibleSection"><h4 class="subHeading" id="SubSection1-General">General</h4><div class="subsection"><p>
								The plugin must reference the ETABSv1 API library (either ETABSv1.DLL for .NET based or ETABSv1.TLB for COM based plugins),
								which must be registered on the developer’s and the user’s systems.
								This registration takes place during the installation of ETABS,
								but can be repeated whenever necessary by running the <strong>RegisterETABS.exe</strong> utility
								included in the program installation folder.
							</p><p>
								The ETABS program targets .NET 8 and is compatible with 64-bit and AnyCPU-compiled plugins referencing ETABSv1.dll
								and targeting .NET Standard 2.0, .NET Framework 4.6.1 and newer (including the latest - 4.8.1),
								.NET Core/.NET 2.0 and newer (including the latest - 8.0) along with 64-bit plugins exposed as COM objects.
								Any kind of 32-bit plugins are not supported.
							</p><p>
								Please make sure your plugin is stable, handles errors well,
								and does not cause any unintended changes to the user’s model
								as actions performed by plugins are not undoable.
							</p><p>
								We will attempt to maintain a stable interface in ETABS, however,
								that cannot be guaranteed, and updates to your plugin may be required
								for future versions of ETABS.
							</p></div><h4 class="subHeading" id="SubSection2-Framework">Plugins Targeting .NET Framework</h4><div class="subsection"><p>
								Please note that plugins targeting .NET Framework
							</p><ul><li>
									Should NOT use .NET Framework technologies unavailable on .NET.
									See
									<a href="https://learn.microsoft.com/en-us/dotnet/core/porting/net-framework-tech-unavailable" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/dotnet/core/porting/net-framework-tech-unavailable</a>
									for details.
								</li><li>
									Should NOT include ETABSv1.dll in the plugin folder to prevent conflicts with ETABSv1.dll located in the program folder.
								</li></ul></div><h4 class="subHeading" id="SubSection3-Core">Plugins Targeting .NET Core/.NET</h4><div class="subsection"><p>
								Please note that plugins targeting .NET Core/.NET
							</p><ul><li>
									Should NOT include ETABSv1.dll in the plugin folder to prevent conflicts with ETABSv1.dll located in the program folder.
								</li><li>
									Should include all other dependencies of the plugin in the plugin folder.
								</li></ul><p>
								See
								<a href="https://learn.microsoft.com/en-us/dotnet/core/tutorials/creating-app-with-plugin-support#simple-plugin-with-no-dependencies" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/dotnet/core/tutorials/creating-app-with-plugin-support#simple-plugin-with-no-dependencies</a>
								for details
							</p></div><h4 class="subHeading" id="SubSection4-COM">Plugins Exposed as COM Objects</h4><div class="subsection"><p>
								Please note that plugins exposed as COM objects
							</p><ul><li>
									Must be registered for COM on the user’s system, preferably after ETABS has been installed.
								</li><li>
									Will require administrative rights to register, which many end users may not have.
								</li></ul><p>
								It is the plugin developer's responsibility to instruct users how to install the plugin.
							</p></div><h4 class="subHeading" id="SubSection5-Compatibility">Plugin Compatibility</h4><div class="subsection"><p>
								Please consider the following recommendations when implementing a plugin
								based on the plugin's functionality and its target audience.
							</p><ul><li>
									For simple plugins with no user interface, targeting .NET Standard 2.0
									should ensure maximum compatibility with old, current, and future versions of ETABS.
								</li><li>
									For more complex plugins with a user interface,
									targeting .NET Framework 4.8 should ensure maximum compatibility
									with old, current, and future versions of ETABS,
									provided that the plugin does not use .NET Framework technologies unavailable on .NET.
								</li><li>
									For plugins meant to be used with ETABS v22.0.0 and later,
									targeting .NET 8 should enable latest .NET functionality
									while ensuring maximum compatibility with current and future versions of ETABS.
								</li><li>
									Plugins developed using native languages like C, C++, can be exposed as COM objects.
									Unlike plugins targeting a version of .NET, plugins exposed as COM objects
									will need to be registered before they can be used.
								</li></ul></div></div><div class="collapsibleAreaRegion" id="cPluginClass"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />The cPlugin Class</span></div><div id="ID2RBSection" class="collapsibleSection"><p>
					In order for ETABS to be able to launch your plugin,
					your plugin assembly must contain a class called <span class="code">cPlugin</span>
					that implements the <span class="code">cPluginContract</span> interface in the ETABS API.
				</p><p>
					Please refer to the <span class="code">cPluginContract</span> page for an explanation of its methods.
					They are also described below.
				</p><p>
					Class <span class="code">cPlugin</span> must contain two methods,
					<span class="code">cPlugin.Info</span> and <span class="code">cPlugin.Main</span></p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EALBCAAA_tab1" class="codeSnippetContainerTabSingle">VB</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EALBCAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EALBCAAA');return false;" title="Copy">Copy</a></div></div><div id="ID1EALBCAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Function</span> Info(<span class="highlight-keyword">ByRef</span> Text <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span>) <span class="highlight-keyword">As</span> <span class="highlight-keyword">Integer</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EALBCAAA");</script><p>
					The function <span class="code">cPlugin.Info</span> has one reference argument, <span class="code">Text</span>,
					and returns a 32-bit signed integer. The return value should be zero if successful.
					The string argument should be filled in by the function, and may be plain text or rich text.
					This string will be displayed when the user first adds the plugin to ETABS.
					You can use this string to tell the user the purpose and author of the plugin.
					This is in addition to any information you may provide when the user executes the plugin.
				</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EAJBCAAA_tab1" class="codeSnippetContainerTabSingle">VB</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAJBCAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAJBCAAA');return false;" title="Copy">Copy</a></div></div><div id="ID1EAJBCAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> Main(<span class="highlight-keyword">ByRef</span> SapModel <span class="highlight-keyword">As</span> ETABSv1.cSapModel, <span class="highlight-keyword">ByRef</span> ISapPlugin <span class="highlight-keyword">As</span> ETABSv1.cPluginCallback)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAJBCAAA");</script><p>
					The subroutine <span class="code">cPlugin.Main</span> is the entry point to launch your plugin.
					All functionality in your plugin will proceed from this method. If your plugin has an initial form,
					it should be opened within this method.
				</p><p><span class="code">cPlugin.Main</span> has two reference arguments of types <span class="code">ETABSv1.cSapModel</span>
					and <span class="code">ETABSv1.cPluginCallback</span>:
				</p><p>
					The <span class="code">SapModel</span> argument is a reference to the SapModel object
					upon which all operations will be performed
				</p><p>
					For the <span class="code">ISapPlugin</span> argument, please refer to the <span class="code">cPluginCallback</span> page
					for an explanation of its properties. Its only method is very important and explained below.
				</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EAEBCAAA_tab1" class="codeSnippetContainerTabSingle">VB</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAEBCAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAEBCAAA');return false;" title="Copy">Copy</a></div></div><div id="ID1EAEBCAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">ETABSv1.cPluginCallback.Finish(<span class="highlight-keyword">ByVal</span> iVal <span class="highlight-keyword">As</span> <span class="highlight-keyword">Integer</span>)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAEBCAAA");</script><p><span class="code">ETABSv1.cPluginCallback</span> contains a <span class="code">Finish</span> subroutine that must be called immediately before the plugin closes
					(e.g., if the plugin has a single main window, at the end of the close event of that form).
					Its one argument, <span class="code">iVal</span>, is an error flag to let ETABS know if the operation was successful or not.
					Zero indicates no error.
					ETABS will wait indefinitely for <span class="code">ETABSv1.cPluginCallback.Finish</span> to be called,
					so the plugin programmer must make sure that it is called when the plugin completes.
				</p><p>
					It is OK for <span class="code">cPlugin.Main</span> to return before the actual work is completed
					(e.g., return after displaying a form where the functionality implemented in the plugin can be accessed
					through different command buttons). However, it is imperative to call <span class="code">ETABSv1.cPluginCallback.Finish</span>
					to return control back to ETABS when the plugin is ready to close.
				</p><p>
					Your plugin should include options for the user to obtain information
					about the product, developer, and technical support.
					Support for your plugin will not be provided by Computers and Structures, Inc.
				</p><p>
					As currently implemented, the cPlugin object will be destroyed between invocations
					from the ETABS Tools menu command that calls it, so data cannot be saved.
				</p></div><div class="collapsibleAreaRegion" id="AddingPlugins"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Adding Plugins</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading" id="PluginImage" /><div class="subsection"><div class="mediaCenter"><img alt="Blank Plugin Window" src="../media/BlankPluginWindow.PNG" /><div class="caption">External Plugin Data Form</div></div></div><h4 class="subHeading" id="AddingCOMPlugin">Adding a COM Plugin</h4><div class="subsection"><p>
								To add a COM plugin to the Tools menu in ETABS, users will select "Add/Show Plugins" from the Tools menu.
								In the External Plugin Data form, they will type the name of the COM server DLL in the "Plugin Name" field.
							</p><p>
								Please note that ETABS will look for the plugin by Type Library name (usually the name of the plugin project),
								which you define when developing your COM server DLL.
								We suggest using a unique name such as ETABSPlugIn_xxx_yyy, where xxx is your (company) name,
								and yyy is the name to distinguish the plugin from other plugins that you develop, e.g. ETABSPlugIn_OmniCorp_Robo1.
							</p><p>
								The "Plugin Name" must exactly match the COM server DLL name.
								However, the plugin will appear under the Tools menu under the "Menu Text" name.
								That can be whatever the user likes, but it should be different for each plugin added.
							</p><p>
								The "Plugin Path" field should be left blank for COM plugins.
							</p><p>
								After clicking the "Add" button, the "Status" field will indicate whether the plugin was successfully located in the registry and loaded.
							</p></div><h4 class="subHeading" id="AddingNETPlugin">Adding a .NET Plugin</h4><div class="subsection"><p>
								The process for adding a .NET plugin is much simpler. In the External Plugin Data form,
								the user should simply browse for and select the plugin .NET DLL and click the "Add" button.
								The rest of the fields will be automatically populated.
								It is still recommended that .NET plugins be given unique names.
							</p></div></div></div></div><div id="pageFooter" class="pageFooter">ETABS®, SAFE®, SAP2000® and CSiBridge® are registered trademarks of Computers and Structures, Inc.<br /><p><a href="https://www.csiamerica.com" target="_blank" rel="noopener noreferrer">Copyright © Computers and Structures, Inc. 2024. All rights reserved.</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:support%40csiamerica.com?Subject=CSI%20API%20ETABS%20v1">support@csiamerica.com</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>