# Excel Regression Snapshots

This folder contains baseline CSV snapshots for regression testing.

## Purpose

When VBA/Excel changes are made, run the test suite and compare outputs 
against these baselines to detect unintended calculation changes.

## Files

| File | Description | Generated By |
|------|-------------|--------------|
| `baseline_beam_design_v0.9.1.csv` | BEAM_DESIGN output from integration tests | `Integration_TestHarness.Export_BEAM_DESIGN_ToCSV` |

> **Future baselines:** Additional baselines (flexure-only, shear-only) can be
> added as needed by extracting subsets from the main design output.

## How to Use

### Generate New Snapshot

1. Open `Excel/StructEng_BeamDesign_v0.5.xlsm`
2. Run: `Integration_TestHarness.Run_And_Export_Integration_Snapshot`
3. Save the CSV to this folder with version suffix

### Compare Against Baseline

Use `diff` or a spreadsheet comparison tool:

```bash
diff baseline_beam_design_v0.9.1.csv new_output.csv
```

### Updating Baseline

When calculations intentionally change (new version, bug fix):
1. Run integration tests
2. Review changes vs old baseline
3. If changes are expected, rename new output as new baseline
4. Update version suffix

## Baseline Data (Embedded)

For quick reference, the baseline test vectors are:

### Test Cases (Input)

| ID | fck | fy | b | D | Mu | Vu | Flanged |
|----|-----|-----|-----|-----|------|------|---------|
| Singly_OK | 25 | 500 | 230 | 450 | 150 | 100 | No |
| Flanged_OK | 25 | 500 | 300 | 550 | 200 | 120 | Yes |
| High_Mu_Doubly | 30 | 415 | 250 | 500 | 260 | 110 | No |
| High_Vu_Shear | 20 | 500 | 230 | 450 | 120 | 250 | No |
| Shear_Over_Tcmax | 20 | 500 | 200 | 450 | 80 | 400 | No |

### Expected Outputs (Baseline v0.9.1)

| ID | Ast_required | Mu_lim | tv | tc | is_safe |
|----|--------------|--------|------|------|---------|
| Singly_OK | ~850 mm² | ~180 kN·m | 0.97 | 0.56 | TRUE |
| Flanged_OK | ~920 mm² | ~350 kN·m | 0.73 | 0.50 | TRUE |
| High_Mu_Doubly | ~1650 mm² | ~195 kN·m | 0.98 | 0.72 | TRUE |
| High_Vu_Shear | ~720 mm² | ~140 kN·m | 2.42 | 0.56 | depends |
| Shear_Over_Tcmax | ~550 mm² | ~115 kN·m | 4.44 | 0.45 | FALSE |

*Note: Exact values depend on implementation details. These are reference ranges.*

## Version History

| Version | Date | Notes |
|---------|------|-------|
| 0.9.1 | 2025-12-26 | Initial baseline with 5 test cases |
