<html><head><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Visual Basic .NET or C#</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="4dec0ec0-1983-4c07-90de-864a674842f0" /><meta name="Microsoft.Help.ContentType" content="How To" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">CSI API ETABS v1</div><div class="pageBody"><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Visual Basic .NET or C#</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p /></div><div class="subSection"><ol><li><p>
							Create a new project of type Windows Form Application.
							Your project can target .NET 8 or .NET Framework 4.8 ,
							the example code is designed to be compatible with either.
						</p><p>
							Note: For C# , it will be helpful to name
							your project WindowsFormsApplication1 ,
							to match the copy-paste code below.
						</p></li><li><p>
							Add a reference to <strong>ETABSv1.dll</strong> to the .NET project.
							This file is located in the directory where ETABS is installed,
							typically <strong>C:\Program Files\Computers and Structures\ETABS 22\</strong></p></li><li><p>
							Add a button to the form, double-click the button, then paste in the following, ready-to-run code.
						</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EDAAABDAAA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDAAABDAAA','cs','1','4');return false;">C#</a></div><div id="ID0EDAAABDAAA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDAAABDAAA','vb','2','4');return false;">VB</a></div><div id="ID0EDAAABDAAA_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="javascript:ChangeTab('ID0EDAAABDAAA','cpp','3','4');return false;">C++</a></div><div id="ID0EDAAABDAAA_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="javascript:ChangeTab('ID0EDAAABDAAA','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EDAAABDAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EDAAABDAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EDAAABDAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">using</span> System;
<span class="highlight-keyword">using</span> System.Windows.Forms;

<span class="highlight-keyword">namespace</span> WindowsFormsApplication1
{
    <span class="highlight-keyword">public</span> <span class="highlight-keyword">partial</span> <span class="highlight-keyword">class</span> Form1 : Form
    {
        <span class="highlight-keyword">public</span> Form1()
        {
            InitializeComponent();
        }

        <span class="highlight-keyword">private</span> <span class="highlight-keyword">void</span> button1_Click(<span class="highlight-keyword">object</span> sender, EventArgs e)
        {
            <span class="highlight-comment">//set the following flag to true to attach to an existing instance of the program </span>
            <span class="highlight-comment">//otherwise a new instance of the program will be started </span>
            <span class="highlight-keyword">bool</span> AttachToInstance;
            AttachToInstance = <span class="highlight-keyword">false</span>;

            <span class="highlight-comment">//set the following flag to true to manually specify the path to ETABS.exe</span>
            <span class="highlight-comment">//this allows for a connection to a version of ETABS other than the latest installation</span>
            <span class="highlight-comment">//otherwise the latest installed version of ETABS will be launched</span>
            <span class="highlight-keyword">bool</span> SpecifyPath;
            SpecifyPath = <span class="highlight-keyword">false</span>;

            <span class="highlight-comment">//if the above flag is set to true, specify the path to ETABS below</span>
            <span class="highlight-keyword">string</span> ProgramPath;
            ProgramPath = <span class="highlight-literal">@"C:\Program Files\Computers and Structures\ETABS 22\ETABS.exe"</span>;

            <span class="highlight-comment">//full path to the model </span>
            <span class="highlight-comment">//set it to an already existing folder </span>
            <span class="highlight-keyword">string</span> ModelDirectory = <span class="highlight-literal">@"C:\CSi_ETABS_API_Example"</span>;
            <span class="highlight-keyword">try</span>
            {
                System.IO.Directory.CreateDirectory(ModelDirectory);
            }
            <span class="highlight-keyword">catch</span> (Exception ex)
            {
                MessageBox.Show(<span class="highlight-literal">"Could not create directory: "</span> + ModelDirectory);
            }

            <span class="highlight-keyword">string</span> ModelName = <span class="highlight-literal">"ETABS_API_Example.edb"</span>;
            <span class="highlight-keyword">string</span> ModelPath = ModelDirectory + System.IO.Path.DirectorySeparatorChar + ModelName;

            <span class="highlight-comment">//dimension the ETABS Object as cOAPI type</span>
            ETABSv1.cOAPI myETABSObject = <span class="highlight-keyword">null</span>;

            <span class="highlight-comment">//Use ret to check if functions return successfully (ret = 0) or fail (ret = nonzero) </span>
            <span class="highlight-keyword">int</span> ret = <span class="highlight-number">0</span>;

            <span class="highlight-comment">//create API helper object</span>
            ETABSv1.cHelper myHelper;
            <span class="highlight-keyword">try</span>
            {
                myHelper = <span class="highlight-keyword">new</span> ETABSv1.Helper();
            }
            <span class="highlight-keyword">catch</span> (Exception ex)
            {
                MessageBox.Show(<span class="highlight-literal">"Cannot create an instance of the Helper object"</span>);
                <span class="highlight-keyword">return</span>;
            }

            <span class="highlight-keyword">if</span> (AttachToInstance)
            {
                <span class="highlight-comment">//attach to a running instance of ETABS </span>
                <span class="highlight-keyword">try</span>
                {
                    <span class="highlight-comment">//get the active ETABS object</span>
                    myETABSObject = myHelper.GetObject(<span class="highlight-literal">"CSI.ETABS.API.ETABSObject"</span>);
                }
                <span class="highlight-keyword">catch</span> (Exception ex)
                {
                    MessageBox.Show(<span class="highlight-literal">"No running instance of the program found or failed to attach."</span>);
                    <span class="highlight-keyword">return</span>;
                }
            }
            <span class="highlight-keyword">else</span>
            {
                <span class="highlight-keyword">if</span> (SpecifyPath)
                {
                    <span class="highlight-comment">//'create an instance of the ETABS object from the specified path</span>
                    <span class="highlight-keyword">try</span>
                    {
                        <span class="highlight-comment">//create ETABS object</span>
                        myETABSObject = myHelper.CreateObject(ProgramPath);
                    }
                    <span class="highlight-keyword">catch</span> (Exception ex)
                    {
                        MessageBox.Show(<span class="highlight-literal">"Cannot start a new instance of the program from "</span> + ProgramPath);
                        <span class="highlight-keyword">return</span>;
                    }
                }
                <span class="highlight-keyword">else</span>
                {
                    <span class="highlight-comment">//'create an instance of the ETABS object from the latest installed ETABS</span>
                    <span class="highlight-keyword">try</span>
                    {
                        <span class="highlight-comment">//create ETABS object</span>
                        myETABSObject = myHelper.CreateObjectProgID(<span class="highlight-literal">"CSI.ETABS.API.ETABSObject"</span>);
                    }
                    <span class="highlight-keyword">catch</span> (Exception ex)
                    {
                        MessageBox.Show(<span class="highlight-literal">"Cannot start a new instance of the program."</span>);
                        <span class="highlight-keyword">return</span>;
                    }
                }
                <span class="highlight-comment">//start ETABS application</span>
                ret = myETABSObject.ApplicationStart();
            }

            <span class="highlight-comment">//Get a reference to cSapModel to access all API classes and functions</span>
            ETABSv1.cSapModel mySapModel = <span class="highlight-keyword">default</span>(ETABSv1.cSapModel);
            mySapModel = myETABSObject.SapModel;

            <span class="highlight-comment">//Initialize model</span>
            ret = mySapModel.InitializeNewModel();

            <span class="highlight-comment">//Create steel deck template model</span>
            ret = mySapModel.File.NewSteelDeck(<span class="highlight-number">4</span>, <span class="highlight-number">12</span>, <span class="highlight-number">12</span>, <span class="highlight-number">4</span>, <span class="highlight-number">4</span>, <span class="highlight-number">24</span>, <span class="highlight-number">24</span>);

            <span class="highlight-comment">//Save model</span>
            ret = mySapModel.File.Save(ModelPath);

            <span class="highlight-comment">//Run analysis</span>
            ret = mySapModel.Analyze.RunAnalysis();

            <span class="highlight-comment">//Close ETABS</span>
            myETABSObject.ApplicationExit(<span class="highlight-keyword">false</span>);

            <span class="highlight-comment">//Clean up variables</span>
            mySapModel = <span class="highlight-keyword">null</span>;
            myETABSObject = <span class="highlight-keyword">null</span>;

            <span class="highlight-comment">//Check ret value </span>
            <span class="highlight-keyword">if</span> (ret == <span class="highlight-number">0</span>)
            {
                MessageBox.Show(<span class="highlight-literal">"API script completed successfully."</span>);
            }
            <span class="highlight-keyword">else</span>
            {
                MessageBox.Show(<span class="highlight-literal">"API script FAILED to complete."</span>);
            }
        }
    }
}</pre></div><div id="ID0EDAAABDAAA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Class</span> Form1

    <span class="highlight-keyword">Private</span> <span class="highlight-keyword">Sub</span> Button1_Click(sender <span class="highlight-keyword">As</span> <span class="highlight-keyword">Object</span>, e <span class="highlight-keyword">As</span> EventArgs) <span class="highlight-keyword">Handles</span> Button1.Click

        <span class="highlight-comment">'set the following flag to True to attach to a running instance of the program</span>
        <span class="highlight-comment">'otherwise a new instance of the program will be started</span>
        <span class="highlight-keyword">Dim</span> AttachToInstance <span class="highlight-keyword">As</span> <span class="highlight-keyword">Boolean</span>
        AttachToInstance = <span class="highlight-keyword">False</span>

        <span class="highlight-comment">'set the following flag to True to manually specify the path to ETABS.exe</span>
        <span class="highlight-comment">'this allows for a connection to a version of ETABS other than the latest installation</span>
        <span class="highlight-comment">'otherwise the latest installed version of ETABS will be launched</span>
        <span class="highlight-keyword">Dim</span> SpecifyPath <span class="highlight-keyword">As</span> <span class="highlight-keyword">Boolean</span>
        SpecifyPath = <span class="highlight-keyword">False</span>

        <span class="highlight-comment">'if the above flag is set to True, specify the path to ETABS below</span>
        <span class="highlight-keyword">Dim</span> ProgramPath <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span>
        <span class="highlight-comment">'ProgramPath = "C:\Program Files (x86)\Computers and Structures\ETABS 22\ETABS.exe"</span>

        <span class="highlight-comment">'full path to the model</span>
        <span class="highlight-comment">'set it to an already existing folder</span>
        <span class="highlight-keyword">Dim</span> ModelDirectory <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = <span class="highlight-literal">"C:\CSi_ETABS_API_Example"</span>
        <span class="highlight-keyword">Try</span>
            System.IO.Directory.CreateDirectory(ModelDirectory)
        <span class="highlight-keyword">Catch</span> ex <span class="highlight-keyword">As</span> Exception
            MsgBox(<span class="highlight-literal">"Could not create directory: "</span> + ModelDirectory)
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">Try</span>

        <span class="highlight-keyword">Dim</span> ModelName <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = <span class="highlight-literal">"ETABS_API_Example.edb"</span>
        <span class="highlight-keyword">Dim</span> ModelPath <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = ModelDirectory + System.IO.Path.DirectorySeparatorChar + ModelName

        <span class="highlight-comment">'dimension the ETABS Object as cOAPI type</span>
        <span class="highlight-keyword">Dim</span> myETABSObject <span class="highlight-keyword">As</span> ETABSv1.cOAPI = <span class="highlight-keyword">Nothing</span>

        <span class="highlight-comment">'Use ret to check if functions return successfully (ret = 0) or fail (ret = nonzero)</span>
        <span class="highlight-keyword">Dim</span> ret <span class="highlight-keyword">As</span> <span class="highlight-keyword">Integer</span>

        <span class="highlight-comment">'create API helper object</span>
        <span class="highlight-keyword">Dim</span> myHelper <span class="highlight-keyword">As</span> ETABSv1.cHelper
        <span class="highlight-keyword">Try</span>
            myHelper = <span class="highlight-keyword">New</span> ETABSv1.Helper
        <span class="highlight-keyword">Catch</span> ex <span class="highlight-keyword">As</span> Exception
            MsgBox(<span class="highlight-literal">"Cannot create an instance of the Helper object"</span>)
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">Try</span>

        <span class="highlight-keyword">If</span> AttachToInstance <span class="highlight-keyword">Then</span>
            <span class="highlight-comment">'attach to a running instance of ETABS</span>
            <span class="highlight-keyword">Try</span>
                <span class="highlight-comment">'get the active ETABS object</span>
                myETABSObject = myHelper.GetObject(<span class="highlight-literal">"CSI.ETABS.API.ETABSObject"</span>)
            <span class="highlight-keyword">Catch</span> ex <span class="highlight-keyword">As</span> Exception
                MsgBox(<span class="highlight-literal">"No running instance of the program found or failed to attach."</span>)
                <span class="highlight-keyword">Return</span>
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">Try</span>
        <span class="highlight-keyword">Else</span>
            <span class="highlight-keyword">If</span> SpecifyPath <span class="highlight-keyword">Then</span>
                <span class="highlight-keyword">Try</span>
                    <span class="highlight-comment">'create an instance of the ETABS object from the specified path</span>
                    myETABSObject = myHelper.CreateObject(ProgramPath)
                <span class="highlight-keyword">Catch</span> ex <span class="highlight-keyword">As</span> Exception
                    MsgBox(<span class="highlight-literal">"Cannot start a new instance of the program from "</span> + ProgramPath)
                    <span class="highlight-keyword">Return</span>
                <span class="highlight-keyword">End</span> <span class="highlight-keyword">Try</span>
            <span class="highlight-keyword">Else</span>
                <span class="highlight-keyword">Try</span>
                    <span class="highlight-comment">'create an instance of the ETABS object from the latest installed ETABS</span>
                    myETABSObject = myHelper.CreateObjectProgID(<span class="highlight-literal">"CSI.ETABS.API.ETABSObject"</span>)
                <span class="highlight-keyword">Catch</span> ex <span class="highlight-keyword">As</span> Exception
                    MsgBox(<span class="highlight-literal">"Cannot start a new instance of the program."</span>)
                    <span class="highlight-keyword">Return</span>
                <span class="highlight-keyword">End</span> <span class="highlight-keyword">Try</span>
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

            <span class="highlight-comment">'start ETABS application</span>
            ret = myETABSObject.ApplicationStart()
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

        <span class="highlight-comment">'Get a reference to cSapModel to access all API classes and functions</span>
        <span class="highlight-keyword">Dim</span> mySapModel <span class="highlight-keyword">As</span> ETABSv1.cSapModel
        mySapModel = myETABSObject.SapModel

        <span class="highlight-comment">'Initialize model</span>
        ret = mySapModel.InitializeNewModel()

        <span class="highlight-comment">'Create steel deck template model</span>
        ret = mySapModel.File.NewSteelDeck(<span class="highlight-number">4</span>, <span class="highlight-number">12</span>, <span class="highlight-number">12</span>, <span class="highlight-number">4</span>, <span class="highlight-number">4</span>, <span class="highlight-number">24</span>, <span class="highlight-number">24</span>)

        <span class="highlight-comment">'Save model</span>
        ret = mySapModel.File.Save(ModelPath)

        <span class="highlight-comment">'Run analysis</span>
        ret = mySapModel.Analyze.RunAnalysis()

        <span class="highlight-comment">'Close ETABS</span>
        myETABSObject.ApplicationExit(<span class="highlight-keyword">False</span>)

        <span class="highlight-comment">'Clean up variables</span>
        mySapModel = <span class="highlight-keyword">Nothing</span>
        myETABSObject = <span class="highlight-keyword">Nothing</span>

        <span class="highlight-comment">'Check ret value</span>
        <span class="highlight-keyword">If</span> ret = <span class="highlight-number">0</span> <span class="highlight-keyword">Then</span>
            MsgBox(<span class="highlight-literal">"API script completed successfully."</span>)
        <span class="highlight-keyword">Else</span>
            MsgBox(<span class="highlight-literal">"API script FAILED to complete."</span>)
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Class</span></pre></div><div id="ID0EDAAABDAAA_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="ID0EDAAABDAAA_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EDAAABDAAA");</script></li></ol></div></div></div><div id="pageFooter" class="pageFooter">ETABS®, SAFE®, SAP2000® and CSiBridge® are registered trademarks of Computers and Structures, Inc.<br /><p><a href="https://www.csiamerica.com" target="_blank" rel="noopener noreferrer">Copyright © Computers and Structures, Inc. 2024. All rights reserved.</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:support%40csiamerica.com?Subject=CSI%20API%20ETABS%20v1">support@csiamerica.com</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>